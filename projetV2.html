<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interventions</title>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet" href="addFormStyle.css">
    <link rel="stylesheet" href="jquery-ui-themes-1.12.1/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
<h1 class="display-4">Interventions</h1>
<div id="root">
    <nbrintervention class="textColor"></nbrintervention>
    <interventionlist :interventions="interventions"></interventionlist>
    <pagination></pagination>
    <editinterv ref="editInterv" :interventions="interventions"></editinterv>
</div>


<script src="vue.js"></script>
<script src="vuex.js"></script>
<script>

    Vue.use(Vuex);

    const store = new Vuex.Store({
        state: {
            select: 0,
            totalInterv: 0,
            currentPage: 1,
            startSlice: 0,
            changePage: false,
            prev: false,
            next: false,
            index: 0,
            idInterv: 0,
        },
        getters: {
            getterSelect: state => {
                return state.select
            },
            getterTotalInterv: state => {
                return state.totalInterv
            },
            getterCurrentPage: state => {
                return state.currentPage
            },
            getterStartSlice: state => {
                return state.startSlice
            },
            getterChangePage: state => {
                return state.changePage
            },
            getterPrev: state => {
                return state.prev
            },
            getterNext: state => {
                return state.next
            },
            getterIndex: state => {
                return state.index
            },
            getterIdInterv: state => {
                return state.idInterv
            },
        },
        mutations: {
            editSelect: (state, newValue) => {
                state.select = newValue
            },
            sendTotalPages: (state, newValue) => {
                state.totalInterv = newValue
            },
            editCurrentPage: (state, newValue) => {
                state.currentPage = newValue
            },
            editStartSlice: (state, newValue) => {
                state.startSlice = newValue
            },
            editChangePage: (state, newValue) => {
                state.changePage = newValue
            },
            editPrev: (state, newValue) => {
                state.prev = newValue
            },
            editNext: (state, newValue) => {
                state.next = newValue
            },
            editIndex: (state, newValue) => {
                state.index = newValue
            },
            editIdInterv: (state, newValue) => {
                state.idInterv = newValue
            }
        }
    })


    Vue.component('nbrintervention', {
        data() {
            return {
                value: 10,
            }
        },
        methods: {
            getSelect(){
                store.commit('editStartSlice', 0) // select value change => init tab slice(0, selectVal)
                store.commit('editCurrentPage', 1) // select value change => init current page = 1
                store.commit('editSelect', parseInt(this.value)) // save select value AND typeof(this.value) = string
                store.commit('editChangePage', false) // select value change => init pagination => classic prev-- / next++
            }
        },
        template: `
            <select v-model="value" @change="getSelect()">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
            </select>
        `,
    })


    Vue.component('pagination', {
        data() {
            return {
                nbrPagination: 0,
                myCurrentPage: 1,
            }
        },
        computed: {
            nbrPages() { // nbr pagination
                let itemsPerPage = store.getters.getterSelect,
                    totalInterv = store.getters.getterTotalInterv,
                    searchColumn = store.getters.getterSearchColumn,
                    tabSearch =  store.getters.getterTabSearch

                itemsPerPage === 0 ? itemsPerPage = 10 : itemsPerPage

                let tabLength = ''
                if(searchColumn === true){
                    tabLength = tabSearch.length
                    this.nbrPagination = Math.ceil(tabLength / itemsPerPage)
                }else{
                    tabLength = totalInterv
                    this.nbrPagination = Math.ceil(totalInterv / itemsPerPage)
                }

                this.myCurrentPage = 1

                return this.nbrPagination
            },
        },
        methods: {
            next(){
                let curPage = store.getters.getterCurrentPage,
                    next = store.getters.getterNext,
                    index = store.getters.getterIndex,
                    bolChangePage = store.getters.getterChangePage

                if(bolChangePage === true){ // pagination selected => next with index value
                    next = true
                    store.commit('editNext', next)

                    if(this.myCurrentPage < this.nbrPagination){
                        index += 1
                        this.myCurrentPage = index + 1
                        store.commit('editIndex', index)
                        store.commit('editCurrentPage', this.myCurrentPage)
                    }
                }
                else{ // classic next => current page + 1
                    curPage === 1 ? this.myCurrentPage = 1 : ''
                    this.myCurrentPage < this.nbrPagination ? this.myCurrentPage++ : ''
                    curPage = this.myCurrentPage

                    store.commit('editCurrentPage', curPage)
                }
            },
            prev(){
                let curPage = store.getters.getterCurrentPage,
                    prev = store.getters.getterPrev,
                    index = store.getters.getterIndex,
                    bolChangePage = store.getters.getterChangePage

                if(bolChangePage === true){ // pagination selected => prev with index value
                    if(this.myCurrentPage > 1){

                        prev = true
                        index -= 1
                        this.myCurrentPage = index + 1

                        store.commit('editIndex', index)
                        store.commit('editCurrentPage', this.myCurrentPage)
                        store.commit('editPrev', prev)
                    }
                }else{ // classic prev => current page - 1
                    this.myCurrentPage > 1 ? this.myCurrentPage-- : ''
                    curPage = this.myCurrentPage

                    store.commit('editCurrentPage', curPage)
                }
            },
            goTo(index){ // pagination selected
                this.myCurrentPage = index + 1

                store.commit('editIndex', index)
                store.commit('editCurrentPage', index)
                store.commit('editChangePage', true)
            },
            displayPagination(){
                let itemsPerPage = store.getters.getterSelect,
                    totalInterv = store.getters.getterTotalInterv

                return itemsPerPage !== totalInterv
            }
        },
        template: `
        <div id="pagination" v-if="displayPagination()">
            <a href="#" @click="prev()">&laquo;</a>
                <span v-for="(pageNumber, index) in nbrPages">
                    <a v-if="index === (myCurrentPage - 1)" class="active">{{pageNumber}}</a>
                    <a v-else @click="goTo(index)">{{pageNumber}}</a>
                </span>
            <a href="#" @click="next()">&raquo;</a>
        </div>
        `,
    })


    Vue.component('interventionlist', {
        data() {
            return {
                curPage: 1,
            }
        },
        props: [
            'interventions',
        ],
        computed: {
            filterBy() {
                let totalInterventions = this.interventions.length,
                    selectVal = store.getters.getterSelect,
                    startSlice = store.getters.getterStartSlice,
                    prev = store.getters.getterPrev,

                getCurPage === 1 ? this.curPage = 1 : ''
                selectVal === 0 ? selectVal = 10 : 0
                store.commit('sendTotalPages', totalInterventions)





                    }else{

                    }




                    }
                }
            }
        },
        template: `
        <table>
            <tr>
            </tr>

            <intervention v-for="(interv, index) in filterBy"
             :id="interv.id"
             :type="interv.type"
             :intervenant="interv.intervenant"
             :client="interv.client"
             :etat="interv.etat"
             :date_debut="interv.date_debut"
             :date_fin="interv.date_fin"
             :createur="interv.createur"
            </intervention>
        </table>`,
    })

    Vue.component('intervention', {
        props: [
            'id',
            'type',
            'intervenant',
            'client',
            'etat',
            'date_debut',
            'date_fin',
            'createur',
            'href'
        ],
        template: `
        <tr>
            <td>{{type}}</td>
            <td>{{intervenant}}</td>
            <td>{{client[0].prenom}} {{client[0].nom}}</td>
            <td>{{etat}}</td>
            <td>{{date_debut}}</td>
            <td>{{date_fin}}</td>
            <td>{{createur}}</td>
            <td><button @click="eventDetails(id)">Voir</button></td>
        </tr>`,
        methods:{
            eventDetails(id){
                store.commit('editIdInterv', id)
                vm.$refs.editInterv.initForm()
            }
        }
    })

    Vue.component('editinterv', {
        props: [
            'interventions',
            'id'
        ],
        data() {
            return {
                etat: '',
                createur: '',
                type: '',
                intervenant: '',
                client: {
                    nom: '',
                    prenom: '',
                    adresse1: '',
                    adresse2: '',
                    cp: '',
                    ville: '',
                    telephone: '',
                    mail: '',
                },
                date_debut: '',
                heure_debut: '',
                date_fin: '',
                heure_fin: '',
                produit: {
                    ref: '',
                    qte: '',
                    libelle: '',
                },
                description: '',
                commentaires: '',
                displayForm: false
            }
        },
        template: `
        <form action="" method="post" :class="[displayForm ? 'editForm' : 'displayNone']" @submit.prevent="catchModifDetails">
                <h4>Informations principales</h4>
                <div id="intervInfoDetails">
                        <option>Maintenance</option>
                        <option>Installation</option>
                        <option>Désinstallation</option>
                    </select>
                </div>

                <h4>Client</h4>
                <div id="coordClientDetails">
                </div>

                <h4>Dates et heures</h4>
                <div id="datesDetails">
                </div>

                <div>
                </div>

                <h4>Produit</h4>
                <div id="refProduitDetails">
                </div>

                <h4>Descriptions et commentaires</h4>
                <div id="textareasDetails">
                </div>

                <input type="submit" class="btn btn-secondary" id="enregDetailsBtn" value="Enregistrer"/>
            </form>
        </div>
        `,
        methods: {
            initForm(){
                let id = store.getters.getterIdInterv,
                    getId = id - 1

                this.displayForm = true
                this.type = this.interventions[getId].type

                this.etat = this.interventions[getId].etat
                this.createur = this.interventions[getId].createur
                this.intervenant = this.interventions[getId].intervenant
                this.description = this.interventions[getId].description
                this.commentaires = this.interventions[getId].commentaires

                this.client.nom = this.interventions[getId].client[0].nom
                this.client.prenom = this.interventions[getId].client[0].prenom
                this.client.adresse1 = this.interventions[getId].client[0].adresse1
                this.client.adresse2 = this.interventions[getId].client[0].adresse2
                this.client.cp = this.interventions[getId].client[0].cp
                this.client.ville = this.interventions[getId].client[0].ville
                this.client.telephone = this.interventions[getId].client[0].telephone
                this.client.mail = this.interventions[getId].client[0].mail

                this.date_debut = this.interventions[getId].date_debut
                this.heure_debut = this.interventions[getId].heure_debut
                this.date_fin = this.interventions[getId].date_fin
                this.heure_fin = this.interventions[getId].heure_fin

                this.produit.ref = this.interventions[getId].produit[0].ref
                this.produit.qte = this.interventions[getId].produit[0].qte
                this.produit.libelle = this.interventions[getId].produit[0].libelle
            },
            catchModifDetails(){

                let id = store.getters.getterIdInterv,
                    getId = id - 1

                this.displayForm = false

                return this.interventions[getId].createur =  this.createur,
                    this.interventions[getId].intervenant = this.intervenant,
                    this.interventions[getId].type = this.type,
                    this.interventions[getId].etat = this.etat,
                    this.interventions[getId].description = this.description,
                    this.interventions[getId].commentaires = this.commentaires
            }
        }
    })

    var vm = new Vue({
        el: '#root',
        data: {
            type: '',
            intervenant: '',
            etat: '',
            date_debut: '',
            heure_debut: '',
            date_fin: '',
            heure_fin: '',
            createur: '',
            description: '',
            commentaires: '',
            ref: '',
            qte: '',
            libelle: '',
            nom: '',
            prenom: '',
            adresse1: '',
            adresse2: '',
            cp: '',
            ville: '',
            telephone: '',
            mail: '',
            idInterv: '',
            interventions: [
                {
                    id: 1,
                    type: 'Maintenance',
                    intervenant: 'Charles',
                    etat: 'En cours',
                    date_debut: '01/02/2018',
                    heure_debut: '14:53',
                    date_fin: '02/02/2018',
                    heure_fin: '09:30',
                    createur: 'Florian',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Bouif',
                            prenom: 'Martin',
                            adresse1: 'blablabla',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 2,
                    type: 'Installation',
                    intervenant: 'Charlotte',
                    etat: 'Terminé',
                    date_debut: '06/01/2018',
                    heure_debut: '09:30',
                    date_fin: '06/01/2018',
                    heure_fin: '09:30',
                    createur: 'Thomas',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Plouf',
                            prenom: 'Morgane',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 3,
                    type: 'Maintenance',
                    intervenant: 'Rose',
                    etat: 'A faire',
                    date_debut: '21/12/2017',
                    heure_debut: '09:30',
                    date_fin: '21/12/2017',
                    heure_fin: '09:30',
                    createur: 'Capucine',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Morgane',
                            prenom: 'Clara',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 4,
                    type: 'Maintenance',
                    intervenant: 'Louis',
                    etat: 'A faire',
                    date_debut: '15/02/2018',
                    heure_debut: '05:35',
                    date_fin: '15/02/2018',
                    heure_fin: '06:35',
                    createur: 'Tristan',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Judu',
                            prenom: 'Simon',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 5,
                    type: 'Désinstallation',
                    intervenant: 'Lea',
                    etat: 'En cours',
                    date_debut: '23/01/2018',
                    date_fin: '23/01/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Hugo',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Buehzuu',
                            prenom: 'Mathis',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 6,
                    type: 'Installation',
                    intervenant: 'Elodie',
                    etat: 'A faire',
                    date_debut: '28/01/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '28/01/2018',
                    createur: 'Capucine',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Matin',
                            prenom: 'Martin',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 7,
                    type: 'Installation',
                    intervenant: 'Lou',
                    etat: 'Terminé',
                    date_debut: '16/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '16/02/2018',
                    createur: 'Thomas',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Morgane',
                            prenom: 'Clara',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 8,
                    type: 'Maintenance',
                    intervenant: 'Emilie',
                    etat: 'En cours',
                    date_debut: '19/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '19/02/2018',
                    createur: 'Florian',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Buzeh',
                            prenom: 'Eva',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 9,
                    type: 'Désinstallation',
                    intervenant: 'Aurelien',
                    etat: 'Terminé',
                    date_debut: '05/01/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '05/01/2018',
                    createur: 'Anais',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Judu',
                            prenom: 'Simon',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 10,
                    type: 'Maintenance',
                    intervenant: 'Baptiste',
                    etat: 'Terminé',
                    date_debut: '21/11/2017',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '21/11/2017',
                    createur: 'Jade',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Franklin',
                            prenom: 'Benjamin',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 11,
                    type: 'Maintenance',
                    intervenant: 'Rose',
                    etat: 'A faire',
                    date_debut: '26/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '26/02/2018',
                    createur: 'Anais',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Buehzuu',
                            prenom: 'Mathis',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 12,
                    type: 'Installation',
                    intervenant: 'Lea',
                    etat: 'A faire',
                    date_debut: '26/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    date_fin: '26/02/2018',
                    createur: 'Tristan',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Lekj',
                            prenom: 'Lena',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 13,
                    type: 'Maintenance',
                    intervenant: 'Charles',
                    etat: 'A faire',
                    date_debut: '18/02/2018',
                    date_fin: '18/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Clementine',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Connor',
                            prenom: 'Sarah',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 14,
                    type: 'Maintenance',
                    intervenant: 'Emilie',
                    etat: 'En cours',
                    date_debut: '03/03/2018',
                    date_fin: '03/03/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Florian',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Hiei',
                            prenom: 'Thomas',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 15,
                    type: 'Désinstallation',
                    intervenant: 'Aurélien',
                    etat: 'A faire',
                    date_debut: '01/02/2018',
                    date_fin: '01/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Jade',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Plouf',
                            prenom: 'Morgane',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 16,
                    type: 'Maintenance',
                    intervenant: 'Charles',
                    etat: 'En cours',
                    date_debut: '06/02/2018',
                    date_fin: '06/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Louis',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Nbbie',
                            prenom: 'Quentin',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 17,
                    type: 'Installation',
                    intervenant: 'Louis',
                    etat: 'A faire',
                    date_debut: '14/02/2018',
                    date_fin: '14/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Lea',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Matin',
                            prenom: 'Martin',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 18,
                    type: 'Installation',
                    intervenant: 'Charlotte',
                    etat: 'A faire',
                    date_debut: '22/02/2018',
                    date_fin: '22/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Thomas',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Dujardin',
                            prenom: 'Jean',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 19,
                    type: 'Maintenance',
                    intervenant: 'Lou',
                    etat: 'Terminé',
                    date_debut: '02/01/2018',
                    date_fin: '02/01/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Capucine',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Sgye',
                            prenom: 'Mélanie',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                },
                {
                    id: 20,
                    type: 'Maintenance',
                    intervenant: 'Emilie',
                    etat: 'A faire',
                    date_debut: '06/02/2018',
                    date_fin: '06/02/2018',
                    heure_debut: '05:35',
                    heure_fin: '06:35',
                    createur: 'Lea',
                    description: 'Changer le machin de ce client qui a son ordi qui rame.',
                    commentaires: 'Tout est rentré dans l\'ordre',
                    produit: [
                        {
                            ref: 'Hizhai5896',
                            qte: 1,
                            libelle: 'Test'
                        }
                    ],
                    client: [
                        {
                            nom: 'Buzeh',
                            prenom: 'Eva',
                            adresse1: '26 rue de la Morandière',
                            adresse2: '',
                            cp: '50400',
                            ville: 'Trifouillis les Oies',
                            telephone: '0645825325',
                            mail: 'bouif.martin@gmail.com'
                        }
                    ]
                }

            ]
        },
        methods: {
            catchSubmit() {
                if (this.type == "" || this.intervenant == "" || this.date_debut == "" || this.date_fin == "" || this.createur == "" || this.nom == "" || this.prenom == "" || this.adresse1 == "" || this.cp == "" || this.ville == "" || this.telephone == "") {
                    alert('Merci de remplir tous les champs.')
                } else {
                    var formContainer = document.getElementById("formContainer");
                    formContainer.classList.add("displayNone");
                    var idLastInterv = this.interventions.length - 1;
                    var id = this.interventions[idLastInterv].id;
                    this.interventions.push({
                        id: id + 1,
                        type: this.type,
                        intervenant: this.intervenant,
                        etat: 'A faire',
                        date_debut: this.date_debut,
                        heure_debut: this.heure_debut,
                        date_fin: this.date_fin,
                        heure_fin: this.heure_fin,
                        createur: this.createur,
                        description: this.description,
                        commentaires: this.commentaires,
                        produit: [
                            {
                                ref: this.ref,
                                qte: this.qte,
                                libelle: this.libelle,
                            }
                        ],
                        client: [
                            {
                                nom: this.nom,
                                prenom: this.prenom,
                                adresse1: this.adresse1,
                                adresse2: this.adresse2,
                                cp: this.cp,
                                ville: this.ville,
                                telephone: this.telephone,
                                mail: this.mail
                            }
                        ]
                    });
                    alert("L'intervention a bien été ajoutée!")
                    this.type = "";
                    this.intervenant = "";
                    this.date_debut = "";
                    this.heure_debut = "";
                    this.date_fin = "";
                    this.heure_fin = "";
                    this.createur = "";
                    this.description = "";
                    this.commentaires = "";
                    this.ref = "";
                    this.qte = "";
                    this.libelle = "";
                    this.nom = "";
                    this.prenom = "";
                    this.adresse1 = "";
                    this.adresse2 = "";
                    this.cp = "";
                    this.ville = "";
                    this.telephone = "";
                    this.mail = "";
                }
            },
            catchRemove() {
                if (this.idInterv != "") {
                    var removeFormContainer = document.getElementById("removeFormContainer");
                    removeFormContainer.classList.add("displayNone");
                    var idInterv = this.idInterv;
                    if (window.confirm("Êtes vous sûr de vouloir supprimer l'intervention " + idInterv + " ?")) {
                        if (this.idInterv > 0 && this.idInterv <= this.interventions.length) {
                            for (i = 0; i < this.interventions.length; i++) {
                                if (this.interventions[i].id == idInterv) {
                                    if (this.interventions.splice(i, 1)) {
                                        alert("L'intervention a bien été supprimée");
                                    } else {
                                        alert("Une erreur s'est produite, veuillez réessayer");
                                    }
                                }
                            }
                        } else {
                            alert("Merci de choisir un numéro d'intervention existant!")
                        }
                    }
                } else {
                    alert('Merci de remplir les champs requis!')
                }
            },
            catchModifDetails() {
                //console.log(this.intervenant)
            },
        }
    })





</script>
</body>

</html>


